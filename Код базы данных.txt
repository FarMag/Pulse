CREATE DATABASE pulse_db;

CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(100) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    gender ENUM('male', 'female') NOT NULL,
    birth_date DATE NOT NULL,
    height DECIMAL(5, 2),
    weight DECIMAL(5, 2),
    target_weight DECIMAL(5, 2),
    phis_train ENUM('beginner', 'medium', 'athlete'),
    target_phis ENUM('losing', 'mass', 'keeping', 'longevity'),
    xp INT
);

CREATE TABLE progress_logs (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    date DATE NOT NULL,
    weight DECIMAL(5, 2),
    body_fat_percentage DECIMAL(10, 2),
    steps INT,
    calories_burned DECIMAL(6, 2),
    water DECIMAL(6, 2),
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE recipes (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    calories DECIMAL(6, 2),
    protein DECIMAL(5, 2),
    fat DECIMAL(5, 2),
    carbohydrates DECIMAL(5, 2),
    ingredient_name TEXT
);

CREATE TABLE nutrition_logs (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    recipe_id INT NOT NULL,
    date DATE NOT NULL,
    meal_type ENUM('breakfast', 'lunch', 'dinner', 'snack') NOT NULL,
    food_name VARCHAR(255) NOT NULL,
    calories DECIMAL(6, 2) NOT NULL,
    protein DECIMAL(5, 2),
    fat DECIMAL(5, 2),
    carbohydrates DECIMAL(5, 2),
    grams DECIMAL(5, 2),
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (recipe_id) REFERENCES recipes(id) ON DELETE CASCADE
);

CREATE TABLE workouts (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    category ENUM('strength', 'cardio', 'stretching', 'home', 'other') NOT NULL,
    duration_minutes DECIMAL(5, 2) NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

CREATE TABLE exercises (
    id INT AUTO_INCREMENT PRIMARY KEY,
    workout_id INT NOT NULL,
    name VARCHAR(255) NOT NULL,
    sets DECIMAL(5, 2) NOT NULL,
    reps DECIMAL(5, 2) NOT NULL,
    weight DECIMAL(10, 2),
    rest_time_seconds DECIMAL(5, 2),
    FOREIGN KEY (workout_id) REFERENCES workouts(id) ON DELETE CASCADE
);
